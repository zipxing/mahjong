{"version":3,"sources":["file:///Users/xinzhou/work/mahjong/star/assets/scripts/UIManager.ts"],"names":["UIManager","Button","Vec3","tween","Color","_decorator","ccclass","property","scoreLabel","targetScoreLabel","moveCountLabel","gameOverPanel","finalScoreLabel","resultTitleLabel","restartButton","hintButton","pauseButton","onRestartCallback","onHintCallback","onPauseCallback","isUIInitialized","currentScore","targetScore","moveCount","init","uiReferences","setupButtonEvents","initializeUI","console","log","node","on","EventType","CLICK","onRestartButtonClick","onHintButtonClick","onPauseButtonClick","updateScoreDisplay","updateMoveCountDisplay","hideGameOverPanel","updateGameState","gameState","score","isGameOver","showGameOverPanel","string","animateScoreChange","progress","color","labelNode","to","scale","start","active","isSuccess","efficiency","Math","round","remainingBlocks","animateGameOverPanel","setScale","easing","showScoreIncrease","scoreIncrease","position","showComboEffect","comboCount","setButtonEnabled","buttonType","enabled","button","opacity","showHint","message","duration","setCallbacks","callbacks","onRestart","onHint","onPause","showLoading","hideLoading","getUIState","isGameOverPanelVisible","destroy","off","debugPrintUIState"],"mappings":"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","sourcesContent":["/**\n * UIç®¡ç†å™¨\n * è´Ÿè´£ç®¡ç†æ¸¸æˆç•Œé¢çš„æ˜¾ç¤ºå’Œäº¤äº’\n */\n\nimport { Node, Label, Button, Vec3, tween, Color, _decorator } from 'cc';\nconst { ccclass, property } = _decorator;\n\nexport interface GameState {\n    score: number;\n    targetScore: number;\n    isGameOver: boolean;\n    remainingBlocks: number;\n    moveCount: number;\n}\n\nexport class UIManager {\n    \n    // UIèŠ‚ç‚¹å¼•ç”¨\n    private scoreLabel: Label = null!;\n    private targetScoreLabel: Label = null!;\n    private moveCountLabel: Label = null!;\n    private gameOverPanel: Node = null!;\n    private finalScoreLabel: Label = null!;\n    private resultTitleLabel: Label = null!;\n    private restartButton: Button = null!;\n    private hintButton: Button = null!;\n    private pauseButton: Button = null!;\n    \n    // å›è°ƒæ¥å£\n    private onRestartCallback: (() => void) | null = null;\n    private onHintCallback: (() => void) | null = null;\n    private onPauseCallback: (() => void) | null = null;\n    \n    // UIçŠ¶æ€\n    private isUIInitialized: boolean = false;\n    private currentScore: number = 0;\n    private targetScore: number = 1000;\n    private moveCount: number = 0;\n    \n    /**\n     * åˆå§‹åŒ–UIç®¡ç†å™¨\n     */\n    init(uiReferences: {\n        scoreLabel?: Label,\n        targetScoreLabel?: Label,\n        moveCountLabel?: Label,\n        gameOverPanel?: Node,\n        finalScoreLabel?: Label,\n        resultTitleLabel?: Label,\n        restartButton?: Button,\n        hintButton?: Button,\n        pauseButton?: Button\n    }) {\n        // è®¾ç½®UIå¼•ç”¨\n        this.scoreLabel = uiReferences.scoreLabel || null!;\n        this.targetScoreLabel = uiReferences.targetScoreLabel || null!;\n        this.moveCountLabel = uiReferences.moveCountLabel || null!;\n        this.gameOverPanel = uiReferences.gameOverPanel || null!;\n        this.finalScoreLabel = uiReferences.finalScoreLabel || null!;\n        this.resultTitleLabel = uiReferences.resultTitleLabel || null!;\n        this.restartButton = uiReferences.restartButton || null!;\n        this.hintButton = uiReferences.hintButton || null!;\n        this.pauseButton = uiReferences.pauseButton || null!;\n        \n        // è®¾ç½®æŒ‰é’®äº‹ä»¶\n        this.setupButtonEvents();\n        \n        // åˆå§‹åŒ–UIæ˜¾ç¤º\n        this.initializeUI();\n        \n        this.isUIInitialized = true;\n        console.log('âœ… UIç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ');\n    }\n    \n    /**\n     * è®¾ç½®æŒ‰é’®äº‹ä»¶\n     */\n    private setupButtonEvents() {\n        if (this.restartButton) {\n            this.restartButton.node.on(Button.EventType.CLICK, this.onRestartButtonClick, this);\n        }\n        \n        if (this.hintButton) {\n            this.hintButton.node.on(Button.EventType.CLICK, this.onHintButtonClick, this);\n        }\n        \n        if (this.pauseButton) {\n            this.pauseButton.node.on(Button.EventType.CLICK, this.onPauseButtonClick, this);\n        }\n    }\n    \n    /**\n     * åˆå§‹åŒ–UIæ˜¾ç¤º\n     */\n    private initializeUI() {\n        this.updateScoreDisplay();\n        this.updateMoveCountDisplay();\n        this.hideGameOverPanel();\n    }\n    \n    /**\n     * æ›´æ–°æ¸¸æˆçŠ¶æ€æ˜¾ç¤º\n     */\n    updateGameState(gameState: GameState) {\n        this.currentScore = gameState.score;\n        this.targetScore = gameState.targetScore;\n        this.moveCount = gameState.moveCount;\n        \n        this.updateScoreDisplay();\n        this.updateMoveCountDisplay();\n        \n        if (gameState.isGameOver) {\n            this.showGameOverPanel(gameState);\n        }\n    }\n    \n    /**\n     * æ›´æ–°åˆ†æ•°æ˜¾ç¤º\n     */\n    private updateScoreDisplay() {\n        if (this.scoreLabel) {\n            this.scoreLabel.string = `åˆ†æ•°: ${this.currentScore}`;\n            \n            // åˆ†æ•°å˜åŒ–åŠ¨ç”»\n            this.animateScoreChange();\n        }\n        \n        if (this.targetScoreLabel) {\n            this.targetScoreLabel.string = `ç›®æ ‡: ${this.targetScore}`;\n            \n            // æ ¹æ®å®Œæˆåº¦æ”¹å˜é¢œè‰²\n            const progress = this.currentScore / this.targetScore;\n            if (progress >= 1.0) {\n                this.targetScoreLabel.color = new Color(0, 255, 0, 255); // ç»¿è‰²\n            } else if (progress >= 0.8) {\n                this.targetScoreLabel.color = new Color(255, 165, 0, 255); // æ©™è‰²\n            } else {\n                this.targetScoreLabel.color = new Color(255, 255, 255, 255); // ç™½è‰²\n            }\n        }\n    }\n    \n    /**\n     * æ›´æ–°ç§»åŠ¨æ¬¡æ•°æ˜¾ç¤º\n     */\n    private updateMoveCountDisplay() {\n        if (this.moveCountLabel) {\n            this.moveCountLabel.string = `ç§»åŠ¨: ${this.moveCount}`;\n        }\n    }\n    \n    /**\n     * åˆ†æ•°å˜åŒ–åŠ¨ç”»\n     */\n    private animateScoreChange() {\n        if (!this.scoreLabel) return;\n        \n        const labelNode = this.scoreLabel.node;\n        \n        // ç¼©æ”¾åŠ¨ç”»\n        tween(labelNode)\n            .to(0.1, { scale: new Vec3(1.2, 1.2, 1) })\n            .to(0.1, { scale: new Vec3(1, 1, 1) })\n            .start();\n    }\n    \n    /**\n     * æ˜¾ç¤ºæ¸¸æˆç»“æŸé¢æ¿\n     */\n    private showGameOverPanel(gameState: GameState) {\n        if (!this.gameOverPanel) return;\n        \n        // æ˜¾ç¤ºé¢æ¿\n        this.gameOverPanel.active = true;\n        \n        // è®¾ç½®ç»“æœæ–‡æœ¬\n        const isSuccess = gameState.score >= gameState.targetScore;\n        \n        if (this.resultTitleLabel) {\n            this.resultTitleLabel.string = isSuccess ? \"ğŸ‰ æ­å–œè¿‡å…³ï¼\" : \"ğŸ˜” æ¸¸æˆç»“æŸ\";\n            this.resultTitleLabel.color = isSuccess ? \n                new Color(0, 255, 0, 255) : // ç»¿è‰²\n                new Color(255, 100, 100, 255); // çº¢è‰²\n        }\n        \n        if (this.finalScoreLabel) {\n            const efficiency = gameState.moveCount > 0 ? \n                Math.round((gameState.score / gameState.moveCount) * 100) / 100 : 0;\n                \n            this.finalScoreLabel.string = \n                `æœ€ç»ˆå¾—åˆ†: ${gameState.score}\\n` +\n                `ç›®æ ‡å¾—åˆ†: ${gameState.targetScore}\\n` +\n                `ç§»åŠ¨æ¬¡æ•°: ${gameState.moveCount}\\n` +\n                `å¹³å‡æ•ˆç‡: ${efficiency} åˆ†/æ¬¡\\n` +\n                `å‰©ä½™æ–¹å—: ${gameState.remainingBlocks} ä¸ª`;\n        }\n        \n        // é¢æ¿å‡ºç°åŠ¨ç”»\n        this.animateGameOverPanel();\n    }\n    \n    /**\n     * éšè—æ¸¸æˆç»“æŸé¢æ¿\n     */\n    private hideGameOverPanel() {\n        if (this.gameOverPanel) {\n            this.gameOverPanel.active = false;\n        }\n    }\n    \n    /**\n     * æ¸¸æˆç»“æŸé¢æ¿å‡ºç°åŠ¨ç”»\n     */\n    private animateGameOverPanel() {\n        if (!this.gameOverPanel) return;\n        \n        // åˆå§‹çŠ¶æ€ï¼šç¼©æ”¾ä¸º0\n        this.gameOverPanel.setScale(new Vec3(0, 0, 1));\n        \n        // å¼¹å‡ºåŠ¨ç”»\n        tween(this.gameOverPanel)\n            .to(0.3, { \n                scale: new Vec3(1, 1, 1) \n            }, { \n                easing: 'backOut' \n            })\n            .start();\n    }\n    \n    /**\n     * æ˜¾ç¤ºå¾—åˆ†å¢åŠ åŠ¨ç”»\n     */\n    showScoreIncrease(scoreIncrease: number, position?: Vec3) {\n        if (!this.scoreLabel || scoreIncrease <= 0) return;\n        \n        // åˆ›å»ºä¸´æ—¶åˆ†æ•°å¢åŠ æç¤º\n        // æ³¨æ„ï¼šè¿™é‡Œéœ€è¦åœ¨å®é™…é¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ªä¸´æ—¶èŠ‚ç‚¹æ¥æ˜¾ç¤º\n        console.log(`ğŸ’° +${scoreIncrease} åˆ†ï¼`);\n        \n        // æ›´æ–°åˆ†æ•°æ˜¾ç¤º\n        this.updateScoreDisplay();\n    }\n    \n    /**\n     * æ˜¾ç¤ºè¿å‡»æ•ˆæœ\n     */\n    showComboEffect(comboCount: number) {\n        if (comboCount <= 1) return;\n        \n        console.log(`ğŸ”¥ ${comboCount}è¿å‡»ï¼`);\n        \n        // åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œè¿™é‡Œå¯ä»¥æ˜¾ç¤ºè¿å‡»ç‰¹æ•ˆ\n        // æ¯”å¦‚åˆ›å»ºä¸´æ—¶æ–‡å­—èŠ‚ç‚¹ï¼Œæ’­æ”¾ç²’å­æ•ˆæœç­‰\n    }\n    \n    /**\n     * è®¾ç½®æŒ‰é’®å¯ç”¨æ€§\n     */\n    setButtonEnabled(buttonType: 'hint' | 'pause' | 'restart', enabled: boolean) {\n        let button: Button | null = null;\n        \n        switch (buttonType) {\n            case 'hint':\n                button = this.hintButton;\n                break;\n            case 'pause':\n                button = this.pauseButton;\n                break;\n            case 'restart':\n                button = this.restartButton;\n                break;\n        }\n        \n        if (button) {\n            button.enabled = enabled;\n            button.node.opacity = enabled ? 255 : 128;\n        }\n    }\n    \n    /**\n     * æ˜¾ç¤ºæç¤ºä¿¡æ¯\n     */\n    showHint(message: string, duration: number = 2.0) {\n        console.log(`ğŸ’¡ æç¤º: ${message}`);\n        \n        // åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œè¿™é‡Œå¯ä»¥æ˜¾ç¤ºä¸´æ—¶æç¤ºæ–‡å­—\n        // æ¯”å¦‚åˆ›å»ºä¸€ä¸ªé£˜æµ®çš„æ–‡å­—èŠ‚ç‚¹\n    }\n    \n    /**\n     * é‡æ–°å¼€å§‹æŒ‰é’®ç‚¹å‡»\n     */\n    private onRestartButtonClick() {\n        console.log('ğŸ”„ ç‚¹å‡»é‡æ–°å¼€å§‹æŒ‰é’®');\n        \n        if (this.onRestartCallback) {\n            this.onRestartCallback();\n        }\n        \n        this.hideGameOverPanel();\n    }\n    \n    /**\n     * æç¤ºæŒ‰é’®ç‚¹å‡»\n     */\n    private onHintButtonClick() {\n        console.log('ğŸ’¡ ç‚¹å‡»æç¤ºæŒ‰é’®');\n        \n        if (this.onHintCallback) {\n            this.onHintCallback();\n        }\n    }\n    \n    /**\n     * æš‚åœæŒ‰é’®ç‚¹å‡»\n     */\n    private onPauseButtonClick() {\n        console.log('â¸ï¸ ç‚¹å‡»æš‚åœæŒ‰é’®');\n        \n        if (this.onPauseCallback) {\n            this.onPauseCallback();\n        }\n    }\n    \n    /**\n     * è®¾ç½®å›è°ƒå‡½æ•°\n     */\n    setCallbacks(callbacks: {\n        onRestart?: () => void,\n        onHint?: () => void,\n        onPause?: () => void\n    }) {\n        this.onRestartCallback = callbacks.onRestart || null;\n        this.onHintCallback = callbacks.onHint || null;\n        this.onPauseCallback = callbacks.onPause || null;\n    }\n    \n    /**\n     * æ˜¾ç¤ºåŠ è½½ç•Œé¢\n     */\n    showLoading(message: string = \"åŠ è½½ä¸­...\") {\n        console.log(`â³ ${message}`);\n        // åœ¨å®é™…é¡¹ç›®ä¸­æ˜¾ç¤ºåŠ è½½åŠ¨ç”»\n    }\n    \n    /**\n     * éšè—åŠ è½½ç•Œé¢\n     */\n    hideLoading() {\n        console.log('âœ… åŠ è½½å®Œæˆ');\n        // éšè—åŠ è½½åŠ¨ç”»\n    }\n    \n    /**\n     * è·å–å½“å‰UIçŠ¶æ€\n     */\n    getUIState(): {\n        isGameOverPanelVisible: boolean,\n        currentScore: number,\n        targetScore: number,\n        moveCount: number\n    } {\n        return {\n            isGameOverPanelVisible: this.gameOverPanel ? this.gameOverPanel.active : false,\n            currentScore: this.currentScore,\n            targetScore: this.targetScore,\n            moveCount: this.moveCount\n        };\n    }\n    \n    /**\n     * é”€æ¯UIç®¡ç†å™¨\n     */\n    destroy() {\n        // ç§»é™¤æŒ‰é’®äº‹ä»¶ç›‘å¬\n        if (this.restartButton) {\n            this.restartButton.node.off(Button.EventType.CLICK, this.onRestartButtonClick, this);\n        }\n        \n        if (this.hintButton) {\n            this.hintButton.node.off(Button.EventType.CLICK, this.onHintButtonClick, this);\n        }\n        \n        if (this.pauseButton) {\n            this.pauseButton.node.off(Button.EventType.CLICK, this.onPauseButtonClick, this);\n        }\n        \n        // æ¸…ç©ºå›è°ƒ\n        this.onRestartCallback = null;\n        this.onHintCallback = null;\n        this.onPauseCallback = null;\n        \n        console.log('ğŸ—‘ï¸ UIç®¡ç†å™¨å·²é”€æ¯');\n    }\n    \n    /**\n     * è°ƒè¯•ï¼šæ‰“å°UIçŠ¶æ€\n     */\n    debugPrintUIState() {\n        console.log('ğŸ–¥ï¸ UIçŠ¶æ€:');\n        console.log(`  åˆå§‹åŒ–çŠ¶æ€: ${this.isUIInitialized}`);\n        console.log(`  å½“å‰åˆ†æ•°: ${this.currentScore}`);\n        console.log(`  ç›®æ ‡åˆ†æ•°: ${this.targetScore}`);\n        console.log(`  ç§»åŠ¨æ¬¡æ•°: ${this.moveCount}`);\n        console.log(`  æ¸¸æˆç»“æŸé¢æ¿: ${this.gameOverPanel ? this.gameOverPanel.active : 'null'}`);\n    }\n}\n"]}