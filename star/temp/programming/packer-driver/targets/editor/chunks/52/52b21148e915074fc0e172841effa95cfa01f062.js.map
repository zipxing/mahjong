{"version":3,"sources":["file:///Users/xinzhou/work/mahjong/star/assets/scripts/BoardManager.ts"],"names":["BoardManager","Vec3","UITransform","gameBoardNode","boardData","boardSize","blockSize","blockSpacing","init","adaptToScreenSize","initBoardData","console","log","getTotalBoardSize","defaultBlockSize","defaultBlockSpacing","totalSize","totalWidth","totalHeight","width","height","row","col","type","node","generateBoard","blockManager","name","gameBoardTransform","getComponent","contentSize","anchorPoint","x","y","worldPosition","toFixed","requiredSize","setContentSize","finalContentSize","warn","setAnchorPoint","worldPos","Math","abs","clearBoard","createdCount","blockType","floor","random","getBlockTypeCount","blockNode","createBlockNode","setParent","active","parent","children","length","localPos","gridToLocal","setPosition","error","i","min","child","position","totalBlocks","typeStats","blockData","removeFromParent","startX","startY","prevX","distance","screenToGridPosition","screenPos","boardWorldPos","getWorldPosition","relativeX","relativeY","offsetX","offsetY","blockStep","rawCol","rawRow","max","verifyPos","verifyWorldPos","errorX","errorY","getBlockAt","isValidPosition","getBlockNodeAt","isEmpty","removeBlocks","blocks","forEach","moveBlock","fromRow","fromCol","toRow","toCol","newPos","getBoardData","countRemainingBlocks","count","getEmptySpacesInColumn","emptyCount","getColumnBlocks","push","data","isColumnEmpty","getRightmostNonEmptyColumn","debugPrintBoard","rowStr","toString"],"mappings":"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","sourcesContent":["/**\n * Ê£ãÁõòÁÆ°ÁêÜÂô®\n * Ë¥üË¥£ÁÆ°ÁêÜ10x10ÁöÑÊ∏∏ÊàèÊ£ãÁõòÔºåÂåÖÊã¨Ê£ãÁõòÊï∞ÊçÆÁªìÊûÑ„ÄÅÂùêÊ†áËΩ¨Êç¢„ÄÅÊñπÂùóÂ∏ÉÂ±ÄÁ≠âÂäüËÉΩ\n */\n\nimport { Node, Vec3, UITransform, director } from 'cc';\nimport { BlockManager } from './BlockManager';\n\nexport interface BlockData {\n    type: number;      // ÊñπÂùóÁ±ªÂûã (0-4: ‰∏çÂêåÈ¢úËâ≤, -1: Á©∫‰Ωç)\n    node: Node | null; // ÂØπÂ∫îÁöÑËäÇÁÇπÂØπË±°\n}\n\nexport class BoardManager {\n    private gameBoardNode: Node = null!;\n    private boardData: BlockData[][] = [];\n    private boardSize: number = 10;\n    private blockSize: number = 60;\n    private blockSpacing: number = 5;\n    \n    /**\n     * ÂàùÂßãÂåñÊ£ãÁõòÁÆ°ÁêÜÂô®\n     */\n    init(gameBoardNode: Node, boardSize: number, blockSize: number, blockSpacing: number) {\n        this.gameBoardNode = gameBoardNode;\n        this.boardSize = boardSize;\n        \n        // Âä®ÊÄÅÈÄÇÈÖçÂ±èÂπïÂ∞∫ÂØ∏\n        this.adaptToScreenSize(blockSize, blockSpacing);\n        \n        // ÂàùÂßãÂåñÊ£ãÁõòÊï∞ÊçÆ\n        this.initBoardData();\n        \n        console.log(`‚úÖ Ê£ãÁõòÁÆ°ÁêÜÂô®ÂàùÂßãÂåñÂÆåÊàê ${boardSize}x${boardSize}`);\n        console.log(`üìè ÊúÄÁªàÊñπÂùóÂ∞∫ÂØ∏: ${this.blockSize}px, Èó¥Ë∑ù: ${this.blockSpacing}px`);\n        console.log(`üìê Ê£ãÁõòÊÄªÂ∞∫ÂØ∏: ${this.getTotalBoardSize()}px`);\n    }\n    \n    /**\n     * Âä®ÊÄÅÈÄÇÈÖçÂ±èÂπïÂ∞∫ÂØ∏\n     */\n    private adaptToScreenSize(defaultBlockSize: number, defaultBlockSpacing: number) {\n        console.log(`üîß ‰ΩøÁî®Âõ∫ÂÆöÈÖçÁΩÆÔºåÁ°Æ‰øù‰∏•Ê†º10√ó10ÊñπÂùó`);\n        \n        // ‰øÆÂ§çÈó¥Ë∑ùÈóÆÈ¢òÔºö‰ΩøÁî®ÂêàÁêÜÁöÑÊñπÂùóÂ∞∫ÂØ∏ÂíåÈó¥Ë∑ùÊØî‰æã\n        this.blockSize = 40;  // Áº©Â∞èÊñπÂùóÂà∞40px\n        this.blockSpacing = 6; // Â¢ûÂ§ßÈó¥Ë∑ùÂà∞6px (15%ÁöÑÊñπÂùóÂ∞∫ÂØ∏)\n        \n        const totalSize = this.boardSize * this.blockSize + (this.boardSize - 1) * this.blockSpacing;\n        // 10√ó40 + 9√ó6 = 400 + 54 = 454px\n        \n        console.log(`üìê Âõ∫ÂÆöÈÖçÁΩÆÁªìÊûú:`);\n        console.log(`   - ÊñπÂùóÂ§ßÂ∞è: ${this.blockSize}px`);\n        console.log(`   - ÊñπÂùóÈó¥Ë∑ù: ${this.blockSpacing}px`);\n        console.log(`   - Ê£ãÁõòÊÄªÂ∞∫ÂØ∏: ${totalSize}√ó${totalSize}px`);\n        console.log(`   - ‰∏•Ê†ºÊéßÂà∂: ${this.boardSize}√ó${this.boardSize} = ${this.boardSize * this.boardSize}‰∏™ÊñπÂùó`);\n    }\n    \n    /**\n     * Ëé∑ÂèñÊ£ãÁõòÊÄªÂ∞∫ÂØ∏\n     */\n    private getTotalBoardSize(): {width: number, height: number} {\n        const totalWidth = this.boardSize * this.blockSize + (this.boardSize - 1) * this.blockSpacing;\n        const totalHeight = this.boardSize * this.blockSize + (this.boardSize - 1) * this.blockSpacing;\n        return {width: totalWidth, height: totalHeight};\n    }\n    \n    /**\n     * ÂàùÂßãÂåñÊ£ãÁõòÊï∞ÊçÆÁªìÊûÑ\n     */\n    private initBoardData() {\n        this.boardData = [];\n        for (let row = 0; row < this.boardSize; row++) {\n            this.boardData[row] = [];\n            for (let col = 0; col < this.boardSize; col++) {\n                this.boardData[row][col] = {\n                    type: -1,  // ÂàùÂßã‰∏∫Á©∫\n                    node: null\n                };\n            }\n        }\n    }\n    \n    /**\n     * ÁîüÊàêÊ∏∏ÊàèÊ£ãÁõò\n     */\n    generateBoard(blockManager: BlockManager) {\n        console.log('üé≤ ÁîüÊàêÊñ∞ÁöÑÊ∏∏ÊàèÊ£ãÁõò');\n        \n        // ÊâìÂç∞Â∏ÉÂ±Ä‰ø°ÊÅØ\n        const totalWidth = this.boardSize * this.blockSize + (this.boardSize - 1) * this.blockSpacing;\n        const totalHeight = this.boardSize * this.blockSize + (this.boardSize - 1) * this.blockSpacing;\n        console.log(`üìä Ê£ãÁõòÂ∏ÉÂ±Ä‰ø°ÊÅØ:`);\n        console.log(`   - ÁΩëÊ†ºÂ§ßÂ∞è: ${this.boardSize} √ó ${this.boardSize}`);\n        console.log(`   - ÊñπÂùóÂ∞∫ÂØ∏: ${this.blockSize} √ó ${this.blockSize}px`);\n        console.log(`   - ÊñπÂùóÈó¥Ë∑ù: ${this.blockSpacing}px`);\n        console.log(`   - Ê£ãÁõòÊÄªÂ∞∫ÂØ∏: ${totalWidth} √ó ${totalHeight}px`);\n        console.log(`   - GameBoardËäÇÁÇπ: ${this.gameBoardNode.name}`);\n        \n        // Ê£ÄÊü•GameBoardËäÇÁÇπÁöÑTransformËÆæÁΩÆ\n        const gameBoardTransform = this.gameBoardNode.getComponent(UITransform);\n        if (gameBoardTransform) {\n            const contentSize = gameBoardTransform.contentSize;\n            const anchorPoint = gameBoardTransform.anchorPoint;\n            console.log(`üìê GameBoard UITransform:`);\n            console.log(`   - ContentSize: ${contentSize.width} √ó ${contentSize.height}`);\n            console.log(`   - AnchorPoint: (${anchorPoint.x}, ${anchorPoint.y})`);\n            console.log(`   - ‰∏ñÁïå‰ΩçÁΩÆ: (${this.gameBoardNode.worldPosition.x.toFixed(1)}, ${this.gameBoardNode.worldPosition.y.toFixed(1)})`);\n            \n            // Âº∫Âà∂ËÆæÁΩÆGameBoard‰∏∫Âõ∫ÂÆöÂ∞∫ÂØ∏ (454√ó454)\n            const requiredSize = 454; // 10√ó40 + 9√ó6 = 454\n            console.log(`üîß Âº∫Âà∂ËÆæÁΩÆGameBoard ContentSize‰∏∫: ${requiredSize} √ó ${requiredSize}`);\n            gameBoardTransform.setContentSize(requiredSize, requiredSize);\n            \n            // È™åËØÅËÆæÁΩÆ\n            const finalContentSize = gameBoardTransform.contentSize;\n            console.log(`‚úÖ GameBoardÊúÄÁªàÂ∞∫ÂØ∏: ${finalContentSize.width} √ó ${finalContentSize.height}`);\n            if (anchorPoint.x !== 0.5 || anchorPoint.y !== 0.5) {\n                console.warn(`‚ö†Ô∏è Ëá™Âä®ËÆæÁΩÆGameBoard AnchorPoint‰∏∫: (0.5, 0.5)`);\n                gameBoardTransform.setAnchorPoint(0.5, 0.5);\n                console.log(`‚úÖ Â∑≤Ëá™Âä®ËÆæÁΩÆGameBoard AnchorPoint‰∏∫: (0.5, 0.5)`);\n            }\n            \n            // Ê£ÄÊü•GameBoard‰ΩçÁΩÆÊòØÂê¶ÂêàÁêÜ (Â∫îËØ•Âú®Canvas‰∏≠ÂøÉÈôÑËøë)\n            const worldPos = this.gameBoardNode.worldPosition;\n            if (Math.abs(worldPos.x - 360) > 50 || Math.abs(worldPos.y - 640) > 200) {\n                console.warn(`‚ö†Ô∏è GameBoard‰ΩçÁΩÆÂèØËÉΩ‰∏çÂêàÁêÜ: (${worldPos.x.toFixed(1)}, ${worldPos.y.toFixed(1)})`);\n                console.log(`üí° Âª∫ËÆÆÂú®Cocos CreatorÁºñËæëÂô®‰∏≠Ë∞ÉÊï¥GameBoard‰ΩçÁΩÆÂà∞Â±èÂπï‰∏≠ÂøÉ`);\n            }\n        } else {\n            console.warn(`‚ö†Ô∏è GameBoardËäÇÁÇπÁº∫Â∞ëUITransformÁªÑ‰ª∂`);\n        }\n        \n        // Ê∏ÖÁ©∫Áé∞ÊúâÊ£ãÁõò\n        this.clearBoard();\n        \n        // ‰∏•Ê†ºÁîüÊàê10√ó10ÊñπÂùóÔºåÁªù‰∏çË∂ÖÂá∫\n        console.log(`üéØ ÂºÄÂßã‰∏•Ê†ºÂàõÂª∫ ${this.boardSize}√ó${this.boardSize} = ${this.boardSize * this.boardSize} ‰∏™ÊñπÂùó`);\n        let createdCount = 0;\n        \n        for (let row = 0; row < 10; row++) {\n            for (let col = 0; col < 10; col++) {\n                const blockType = Math.floor(Math.random() * blockManager.getBlockTypeCount());\n                \n                // Ê∑ªÂä†ÈöèÊú∫Êï∞Ë∞ÉËØï\n                if (row < 2 && col < 5) {\n                    console.log(`üé≤ ÊñπÂùó[${row}][${col}] ÈöèÊú∫Á±ªÂûã: ${blockType} (ÂÖ±${blockManager.getBlockTypeCount()}Áßç)`);\n                }\n                \n                // ÂàõÂª∫ÊñπÂùóËäÇÁÇπÔºà‰º†ÈÄíÂä®ÊÄÅËÆ°ÁÆóÁöÑÊñπÂùóÂ∞∫ÂØ∏Ôºâ\n                const blockNode = blockManager.createBlockNode(blockType, this.blockSize);\n                if (blockNode) {\n                    // ËÆæÁΩÆÁà∂ËäÇÁÇπ\n                    blockNode.setParent(this.gameBoardNode);\n                    \n                    // È™åËØÅÊñπÂùóËäÇÁÇπÁ°ÆÂÆûË¢´ÂàõÂª∫ÔºàÂú®ËÆæÁΩÆÁà∂ËäÇÁÇπÂêéÔºâ\n                    if (row === 0 && col === 0) {\n                        console.log(`‚úÖ Á¨¨‰∏Ä‰∏™ÊñπÂùóÂàõÂª∫ÊàêÂäü: ${blockNode.name}, Â∞∫ÂØ∏: ${this.blockSize}√ó${this.blockSize}`);\n                        console.log(`   ÊñπÂùóÊøÄÊ¥ªÁä∂ÊÄÅ: ${blockNode.active}`);\n                        console.log(`   ÊñπÂùóÁà∂ËäÇÁÇπ: ${blockNode.parent?.name}`);\n                        console.log(`   GameBoardÊøÄÊ¥ªÁä∂ÊÄÅ: ${this.gameBoardNode.active}`);\n                        console.log(`   GameBoardÂ≠êËäÇÁÇπÊï∞: ${this.gameBoardNode.children.length}`);\n                    }\n                    \n                    // ËÆæÁΩÆ‰ΩçÁΩÆ\n                    const localPos = this.gridToLocal(row, col);\n                    blockNode.setPosition(localPos);\n                    \n                    // ËÆæÁΩÆÂêçÁß∞‰æø‰∫éË∞ÉËØï\n                    blockNode.name = `Block_${row}_${col}`;\n                    \n                    // Ê∑ªÂä†‰ΩçÁΩÆË∞ÉËØï‰ø°ÊÅØÔºàÁÆÄÂåñÁâàÊú¨Ôºâ\n                    if (row < 3 && col < 3) {\n                        console.log(`üìç ÊñπÂùó[${row}][${col}] ‰ΩçÁΩÆ: (${localPos.x.toFixed(1)}, ${localPos.y.toFixed(1)})`);\n                    }\n                    \n                    // Êõ¥Êñ∞Êï∞ÊçÆ\n                    this.boardData[row][col] = {\n                        type: blockType,\n                        node: blockNode\n                    };\n                    \n                    createdCount++;\n                } else {\n                    console.error(`‚ùå ÊñπÂùó[${row}][${col}]ÂàõÂª∫Â§±Ë¥•ÔºÅ`);\n                }\n            }\n        }\n        \n        console.log(`üéØ ÊñπÂùóÂàõÂª∫ÂÆåÊàê: ÂÆûÈôÖÂàõÂª∫ ${createdCount} ‰∏™ÔºåÈ¢ÑÊúü 100 ‰∏™`);\n        if (createdCount !== 100) {\n            console.error(`‚ùå ÊñπÂùóÊï∞Èáè‰∏çÊ≠£Á°ÆÔºÅÈ¢ÑÊúü100‰∏™ÔºåÂÆûÈôÖ${createdCount}‰∏™`);\n        }\n        \n        // È™åËØÅGameBoardÁä∂ÊÄÅ\n        console.log(`üîç ÊúÄÁªàGameBoardÁä∂ÊÄÅÊ£ÄÊü•:`);\n        console.log(`   - GameBoardÊøÄÊ¥ª: ${this.gameBoardNode.active}`);\n        console.log(`   - GameBoardÂ≠êËäÇÁÇπÊÄªÊï∞: ${this.gameBoardNode.children.length}`);\n        console.log(`   - GameBoard ContentSize: ${this.gameBoardNode.getComponent(UITransform)?.contentSize.width}√ó${this.gameBoardNode.getComponent(UITransform)?.contentSize.height}`);\n        \n        // Ê£ÄÊü•ÂâçÂá†‰∏™Â≠êËäÇÁÇπ\n        for (let i = 0; i < Math.min(3, this.gameBoardNode.children.length); i++) {\n            const child = this.gameBoardNode.children[i];\n            console.log(`   - Â≠êËäÇÁÇπ[${i}]: ${child.name}, ÊøÄÊ¥ª: ${child.active}, ‰ΩçÁΩÆ: (${child.position.x.toFixed(1)}, ${child.position.y.toFixed(1)})`);\n        }\n        \n        // ÊòæÁ§∫ËØäÊñ≠ÂÆåÊàêÔºåÁßªÈô§ÊµãËØïÊñπÂùóÈÅøÂÖçÂπ≤Êâ∞\n        console.log(`‚úÖ ÊòæÁ§∫Á≥ªÁªüÊ≠£Â∏∏ÔºåÂ∑≤Ê∑ªÂä†ÁôΩËâ≤ËæπÊ°ÜÂ∏ÆÂä©ËØÜÂà´ÊñπÂùóËæπÁïå`);\n        \n        // ÁªüËÆ°ÂÆûÈôÖÂàõÂª∫ÁöÑÊñπÂùóÊï∞Èáè\n        let totalBlocks = 0;\n        let typeStats: {[key: number]: number} = {};\n        \n        for (let row = 0; row < this.boardSize; row++) {\n            for (let col = 0; col < this.boardSize; col++) {\n                const blockData = this.boardData[row][col];\n                if (blockData && blockData.node) {\n                    totalBlocks++;\n                    typeStats[blockData.type] = (typeStats[blockData.type] || 0) + 1;\n                }\n            }\n        }\n        \n        console.log(`‚úÖ Ê£ãÁõòÁîüÊàêÂÆåÊàê - ÊÄªËÆ° ${totalBlocks} ‰∏™ÊñπÂùó`);\n        console.log(`üìä ÊñπÂùóÁ±ªÂûãÂàÜÂ∏É:`, typeStats);\n        \n        // Ê£ÄÊü•ÊòØÂê¶ÊúâÊñπÂùóÊ≤°ÊúâÊ≠£Á°ÆÊòæÁ§∫\n        if (totalBlocks < this.boardSize * this.boardSize) {\n            console.warn(`‚ö†Ô∏è ÊñπÂùóÊï∞Èáè‰∏çË∂≥ÔºÅÈ¢ÑÊúü ${this.boardSize * this.boardSize} ‰∏™ÔºåÂÆûÈôÖ ${totalBlocks} ‰∏™`);\n        }\n    }\n    \n    /**\n     * Ê∏ÖÁ©∫Ê£ãÁõò\n     */\n    clearBoard() {\n        for (let row = 0; row < this.boardSize; row++) {\n            for (let col = 0; col < this.boardSize; col++) {\n                if (this.boardData[row][col]?.node) {\n                    this.boardData[row][col].node!.removeFromParent();\n                }\n                this.boardData[row][col] = {\n                    type: -1,\n                    node: null\n                };\n            }\n        }\n    }\n    \n    /**\n     * ÁΩëÊ†ºÂùêÊ†áËΩ¨Êç¢‰∏∫Êú¨Âú∞ÂùêÊ†á\n     */\n    gridToLocal(row: number, col: number): Vec3 {\n        // ËÆ°ÁÆóÊ£ãÁõòÁöÑÊÄªÂ∞∫ÂØ∏\n        const totalWidth = this.boardSize * this.blockSize + (this.boardSize - 1) * this.blockSpacing;\n        const totalHeight = this.boardSize * this.blockSize + (this.boardSize - 1) * this.blockSpacing;\n        \n        // ËÆ°ÁÆóËµ∑ÂßãÂÅèÁßªÔºàËÆ©Ê£ãÁõòÂ±Ö‰∏≠Ôºâ\n        const startX = -totalWidth / 2 + this.blockSize / 2;\n        const startY = totalHeight / 2 - this.blockSize / 2;\n        \n        // ËÆ°ÁÆóÂÖ∑‰Ωì‰ΩçÁΩÆ\n        const x = startX + col * (this.blockSize + this.blockSpacing);\n        const y = startY - row * (this.blockSize + this.blockSpacing);\n        \n        // Ê∑ªÂä†ËØ¶ÁªÜË∞ÉËØï‰ø°ÊÅØÔºàÂâçÂá†‰∏™ÊñπÂùóÔºâ\n        if ((row === 0 && col < 3) || (col === 0 && row < 3)) {\n            console.log(`üîç ÁΩëÊ†ºËΩ¨Êç¢ËØ¶ÊÉÖ [${row}][${col}]:`);\n            console.log(`   Ê£ãÁõòÊÄªÂ∞∫ÂØ∏: ${totalWidth} √ó ${totalHeight}`);\n            console.log(`   Ëµ∑Âßã‰ΩçÁΩÆ: (${startX.toFixed(1)}, ${startY.toFixed(1)})`);\n            console.log(`   ÊñπÂùóÂ∞∫ÂØ∏: ${this.blockSize}px, Èó¥Ë∑ù: ${this.blockSpacing}px`);\n            console.log(`   Ê≠•ÈïøËÆ°ÁÆó: col=${col} √ó (${this.blockSize}+${this.blockSpacing}) = ${col * (this.blockSize + this.blockSpacing)}`);\n            console.log(`   ÊúÄÁªà‰ΩçÁΩÆ: (${x.toFixed(1)}, ${y.toFixed(1)})`);\n            \n            // È™åËØÅÁõ∏ÈÇªÊñπÂùóÈó¥Ë∑ù\n            if (col === 1 && row === 0) {\n                const prevX = startX + 0 * (this.blockSize + this.blockSpacing);\n                const distance = x - prevX;\n                console.log(`   üîç ‰∏éÂâç‰∏ÄÊñπÂùóË∑ùÁ¶ª: ${distance}px (È¢ÑÊúü: ${this.blockSize + this.blockSpacing}px)`);\n                if (Math.abs(distance - (this.blockSize + this.blockSpacing)) > 0.1) {\n                    console.warn(`   ‚ö†Ô∏è Èó¥Ë∑ùÂºÇÂ∏∏ÔºÅ`);\n                }\n            }\n        }\n        \n        return new Vec3(x, y, 0);\n    }\n    \n    /**\n     * Â±èÂπïÂùêÊ†áËΩ¨Êç¢‰∏∫ÁΩëÊ†ºÂùêÊ†á\n     */\n    screenToGridPosition(screenPos: Vec3): {row: number, col: number} {\n        console.log(`\\nüîÑ ===== ÂùêÊ†áËΩ¨Êç¢ÂºÄÂßã =====`);\n        console.log(`üìç ËæìÂÖ•‰∏ñÁïåÂùêÊ†á: (${screenPos.x.toFixed(1)}, ${screenPos.y.toFixed(1)})`);\n        \n        // Ëé∑ÂèñÊ£ãÁõòËäÇÁÇπÁöÑ‰∏ñÁïåÂùêÊ†á\n        const boardWorldPos = this.gameBoardNode.getWorldPosition();\n        console.log(`üéÆ Ê£ãÁõò‰∏ñÁïåÂùêÊ†á: (${boardWorldPos.x.toFixed(1)}, ${boardWorldPos.y.toFixed(1)})`);\n        \n        // ËΩ¨Êç¢‰∏∫Áõ∏ÂØπ‰∫éÊ£ãÁõò‰∏≠ÂøÉÁöÑÂùêÊ†á\n        const relativeX = screenPos.x - boardWorldPos.x;\n        const relativeY = screenPos.y - boardWorldPos.y;\n        console.log(`üìê Áõ∏ÂØπÂùêÊ†á: (${relativeX.toFixed(1)}, ${relativeY.toFixed(1)})`);\n        \n        // ËÆ°ÁÆóÁΩëÊ†ºÂèÇÊï∞\n        const totalWidth = this.boardSize * this.blockSize + (this.boardSize - 1) * this.blockSpacing;\n        const totalHeight = this.boardSize * this.blockSize + (this.boardSize - 1) * this.blockSpacing;\n        console.log(`üìè Ê£ãÁõòÊÄªÂ∞∫ÂØ∏: ${totalWidth} x ${totalHeight}`);\n        \n        // ÁΩëÊ†ºÂ∏ÉÂ±ÄÔºöÊ£ãÁõò‰∏≠ÂøÉ‰∏∫ÂéüÁÇπÔºåÂêëÂ∑¶Âè≥‰∏ä‰∏ãÊâ©Â±ï\n        const startX = -totalWidth / 2 + this.blockSize / 2;  // Á¨¨‰∏Ä‰∏™ÊñπÂùóÁöÑ‰∏≠ÂøÉX\n        const startY = totalHeight / 2 - this.blockSize / 2;   // Á¨¨‰∏Ä‰∏™ÊñπÂùóÁöÑ‰∏≠ÂøÉY\n        console.log(`üèÅ Á¨¨‰∏Ä‰∏™ÊñπÂùó‰∏≠ÂøÉ: (${startX.toFixed(1)}, ${startY.toFixed(1)})`);\n        \n        // ËÆ°ÁÆóÁÇπÂáª‰ΩçÁΩÆÁõ∏ÂØπ‰∫éÁ¨¨‰∏Ä‰∏™ÊñπÂùóÁöÑÂÅèÁßª\n        const offsetX = relativeX - startX;\n        const offsetY = startY - relativeY;  // YËΩ¥Âêë‰∏ã‰∏∫Ê≠£\n        console.log(`üìè Áõ∏ÂØπÁ¨¨‰∏Ä‰∏™ÊñπÂùóÂÅèÁßª: (${offsetX.toFixed(1)}, ${offsetY.toFixed(1)})`);\n        \n        // ËÆ°ÁÆóÁΩëÊ†ºÂùêÊ†á\n        const blockStep = this.blockSize + this.blockSpacing;\n        const rawCol = offsetX / blockStep;\n        const rawRow = offsetY / blockStep;\n        console.log(`üßÆ ÂéüÂßãÁΩëÊ†ºÂùêÊ†á: (${rawRow.toFixed(2)}, ${rawCol.toFixed(2)})`);\n        \n        // ÂèñÊï¥Âπ∂ÈôêÂà∂ËåÉÂõ¥\n        const col = Math.max(0, Math.min(this.boardSize - 1, Math.floor(rawCol + 0.5))); // +0.5 ËøõË°åÂõõËàç‰∫îÂÖ•\n        const row = Math.max(0, Math.min(this.boardSize - 1, Math.floor(rawRow + 0.5)));\n        console.log(`üéØ ÊúÄÁªàÁΩëÊ†ºÂùêÊ†á: (${row}, ${col})`);\n        \n        // È™åËØÅÔºöËÆ°ÁÆóËØ•ÁΩëÊ†º‰ΩçÁΩÆÁöÑÂÆûÈôÖ‰∏ñÁïåÂùêÊ†á\n        const verifyPos = this.gridToLocal(row, col);\n        const verifyWorldPos = new Vec3(verifyPos.x + boardWorldPos.x, verifyPos.y + boardWorldPos.y, 0);\n        console.log(`‚úÖ È™åËØÅÔºöÁΩëÊ†º(${row}, ${col}) ÂØπÂ∫î‰∏ñÁïåÂùêÊ†á (${verifyWorldPos.x.toFixed(1)}, ${verifyWorldPos.y.toFixed(1)})`);\n        \n        // ËÆ°ÁÆóÁÇπÂáªËØØÂ∑Æ\n        const errorX = Math.abs(screenPos.x - verifyWorldPos.x);\n        const errorY = Math.abs(screenPos.y - verifyWorldPos.y);\n        console.log(`üìè ÁÇπÂáªËØØÂ∑Æ: X=${errorX.toFixed(1)}, Y=${errorY.toFixed(1)}`);\n        \n        if (errorX > this.blockSize || errorY > this.blockSize) {\n            console.warn(`‚ö†Ô∏è ÁÇπÂáªËØØÂ∑ÆËøáÂ§ßÔºåÂèØËÉΩÂ≠òÂú®ÂùêÊ†áÁ≥ªÈóÆÈ¢ò`);\n        }\n        \n        console.log(`üîÑ ===== ÂùêÊ†áËΩ¨Êç¢ÁªìÊùü =====\\n`);\n        \n        return { row, col };\n    }\n    \n    /**\n     * Ëé∑ÂèñÊåáÂÆö‰ΩçÁΩÆÁöÑÊñπÂùóÊï∞ÊçÆ\n     */\n    getBlockAt(row: number, col: number): BlockData | null {\n        if (this.isValidPosition(row, col)) {\n            return this.boardData[row][col];\n        }\n        return null;\n    }\n    \n    /**\n     * Ëé∑ÂèñÊåáÂÆö‰ΩçÁΩÆÁöÑÊñπÂùóËäÇÁÇπ\n     */\n    getBlockNodeAt(row: number, col: number): Node | null {\n        const blockData = this.getBlockAt(row, col);\n        return blockData ? blockData.node : null;\n    }\n    \n    /**\n     * Ê£ÄÊü•‰ΩçÁΩÆÊòØÂê¶ÊúâÊïà\n     */\n    isValidPosition(row: number, col: number): boolean {\n        return row >= 0 && row < this.boardSize && col >= 0 && col < this.boardSize;\n    }\n    \n    /**\n     * Ê£ÄÊü•‰ΩçÁΩÆÊòØÂê¶‰∏∫Á©∫\n     */\n    isEmpty(row: number, col: number): boolean {\n        if (!this.isValidPosition(row, col)) return false;\n        return this.boardData[row][col].type === -1;\n    }\n    \n    /**\n     * ÁßªÈô§ÊåáÂÆöÁöÑÊñπÂùó\n     */\n    removeBlocks(blocks: {row: number, col: number}[]) {\n        blocks.forEach(({row, col}) => {\n            if (this.isValidPosition(row, col)) {\n                // Ê≥®ÊÑèÔºöËäÇÁÇπÂ∑≤Âú®Âä®Áîª‰∏≠ÁßªÈô§ÔºåËøôÈáåÂè™Ê∏ÖÁêÜÊï∞ÊçÆ\n                this.boardData[row][col] = {\n                    type: -1,\n                    node: null\n                };\n            }\n        });\n    }\n    \n    /**\n     * ÁßªÂä®ÊñπÂùóÂà∞Êñ∞‰ΩçÁΩÆ\n     */\n    moveBlock(fromRow: number, fromCol: number, toRow: number, toCol: number): boolean {\n        if (!this.isValidPosition(fromRow, fromCol) || !this.isValidPosition(toRow, toCol)) {\n            return false;\n        }\n        \n        if (this.isEmpty(fromRow, fromCol) || !this.isEmpty(toRow, toCol)) {\n            return false;\n        }\n        \n        // ÁßªÂä®Êï∞ÊçÆ\n        this.boardData[toRow][toCol] = this.boardData[fromRow][fromCol];\n        this.boardData[fromRow][fromCol] = {\n            type: -1,\n            node: null\n        };\n        \n        // Êõ¥Êñ∞ËäÇÁÇπ‰ΩçÁΩÆ\n        const blockNode = this.boardData[toRow][toCol].node;\n        if (blockNode) {\n            const newPos = this.gridToLocal(toRow, toCol);\n            blockNode.setPosition(newPos);\n            blockNode.name = `Block_${toRow}_${toCol}`;\n        }\n        \n        return true;\n    }\n    \n    /**\n     * Ëé∑ÂèñÊï¥‰∏™Ê£ãÁõòÊï∞ÊçÆ\n     */\n    getBoardData(): BlockData[][] {\n        return this.boardData;\n    }\n    \n    /**\n     * ËÆ°ÁÆóÂâ©‰ΩôÊñπÂùóÊï∞Èáè\n     */\n    countRemainingBlocks(): number {\n        let count = 0;\n        for (let row = 0; row < this.boardSize; row++) {\n            for (let col = 0; col < this.boardSize; col++) {\n                if (!this.isEmpty(row, col)) {\n                    count++;\n                }\n            }\n        }\n        return count;\n    }\n    \n    /**\n     * Ëé∑ÂèñÊåáÂÆöÂàóÁöÑÁ©∫‰ΩçÊï∞ÈáèÔºà‰ªéÂ∫ïÈÉ®ÂºÄÂßãËÆ°ÁÆóÔºâ\n     */\n    getEmptySpacesInColumn(col: number): number {\n        let emptyCount = 0;\n        for (let row = this.boardSize - 1; row >= 0; row--) {\n            if (this.isEmpty(row, col)) {\n                emptyCount++;\n            } else {\n                break;\n            }\n        }\n        return emptyCount;\n    }\n    \n    /**\n     * Ëé∑ÂèñÊåáÂÆöÂàóÁöÑÊñπÂùóÂàóË°®Ôºà‰ªé‰∏äÂà∞‰∏ãÔºåÂøΩÁï•Á©∫‰ΩçÔºâ\n     */\n    getColumnBlocks(col: number): {row: number, data: BlockData}[] {\n        const blocks: {row: number, data: BlockData}[] = [];\n        for (let row = 0; row < this.boardSize; row++) {\n            if (!this.isEmpty(row, col)) {\n                blocks.push({\n                    row: row,\n                    data: this.boardData[row][col]\n                });\n            }\n        }\n        return blocks;\n    }\n    \n    /**\n     * Ê£ÄÊü•ÂàóÊòØÂê¶ÂÆåÂÖ®‰∏∫Á©∫\n     */\n    isColumnEmpty(col: number): boolean {\n        for (let row = 0; row < this.boardSize; row++) {\n            if (!this.isEmpty(row, col)) {\n                return false;\n            }\n        }\n        return true;\n    }\n    \n    /**\n     * Ëé∑ÂèñÊúÄÂè≥‰æßÈùûÁ©∫ÂàóÁöÑÁ¥¢Âºï\n     */\n    getRightmostNonEmptyColumn(): number {\n        for (let col = this.boardSize - 1; col >= 0; col--) {\n            if (!this.isColumnEmpty(col)) {\n                return col;\n            }\n        }\n        return -1; // ÊâÄÊúâÂàóÈÉΩ‰∏∫Á©∫\n    }\n    \n    /**\n     * Ë∞ÉËØïÔºöÊâìÂç∞Ê£ãÁõòÁä∂ÊÄÅ\n     */\n    debugPrintBoard() {\n        console.log('üìã ÂΩìÂâçÊ£ãÁõòÁä∂ÊÄÅ:');\n        for (let row = 0; row < this.boardSize; row++) {\n            let rowStr = '';\n            for (let col = 0; col < this.boardSize; col++) {\n                const type = this.boardData[row][col].type;\n                rowStr += (type === -1 ? '.' : type.toString()) + ' ';\n            }\n            console.log(rowStr);\n        }\n    }\n}\n"]}